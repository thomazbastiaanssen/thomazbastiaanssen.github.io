{
  "articles": [
    {
      "path": "about.html",
      "title": "Thomaz F. S. Bastiaanssen, PhD",
      "author": [],
      "contents": "\n\n\n\nMade in R using distill and postcards.\n\n\n\n",
      "last_modified": "2024-06-25T15:26:38+02:00"
    },
    {
      "path": "CoDA_MB.html",
      "title": "Compositional Microbiome Data",
      "author": [],
      "contents": "\n\n\n\n\n\n\n\n\nThomaz F. S. Bastiaanssen, PhD\n\n\nHome\nNotes\nMedia\n☰\n\n\n  \n    \n      \n        \n        \n        \n      \n      \n    \n    \n      \n  Home\n\n\n  Notes\n\n\n  Media\n\n      \n  \n\n\n\n\n\n\nCompositional Microbiome Data\n\n\n\n\n\nInterpreting Centered Log-Ratio Transformed Data\nThe centered log-ratio (CLR) transformation may be the most common\napproach to deal with compositional data, such as microbiome sequencing\ndata. To help form intuition on what the CLR transformation does and how\nto interpret it, let’s start by taking a look at the mathematical\nnotation.\nLet’s say we have a microbiome sample which we will treat as a vector\ncalled \\(\\bf{x}\\) with size \\(D\\). We’ll refer to the taxa - or more\ngenerally the elements - of this vector \\(\\bf{x}\\) as \\({x}_1\\) - \\({x}_D\\). Then, CLR-transforming that vector\n\\(\\bf{x}\\) would look like this:\n\\[clr({\\mathbf{x}}) = \\left \\lbrace \\ln\n\\left (\\frac{ {x}_{1}}{G({\\mathbf{x}})} \\right), \\dots, \\ln \\left\n(\\frac{ {x}_{D}}{G({\\mathbf{x}})} \\right) \\right \\rbrace\\]\nWhere \\({G({\\bf x})}\\) is the\ngeometric mean of \\(\\bf{x}\\). Let’s go\nthrough it step by step.\nYou can calculate the geometric mean of a set of n numbers\nby multiplying them together and then taking the nth\nroot. Just like the ‘regular’ mean, the geometric mean says something\nabout the center of your data.\nEssentially what this says is that in order to get the\nCLR-transformed values of a vector, you take every element of that\nvector, divide it by the geometric mean of the entire vector and then\ntake the natural logarithm of the result and you’re done.\nWe can deduce a few things about this\ntransformation.\nFirst, since we’re taking a natural logarithm, \\(\\frac{x_{n}}{G({\\bf x})}\\) can never be\nzero as the logarithm of zero is undefined. This means that we need to\neither replace or remove every zero in our data before we use this\ntransformation. We expand on strategies for this in the main text.\nSecond, the possible range of our data has changed. Regular counts\ncan go from 0 to infinity and relative abundance data can go from 0 to\n1, but CLR-transformed data can go from negative infinity to positive\ninfinity. The logarithm of a very small number divided by a very large\nnumber will be very negative.\nThird, if \\(x_{n}\\) is exactly the\nsame as the geometric mean \\(G({\\bf\nx})\\), \\(\\frac{x_{n}}{G({\\bf\nx})}\\) will be 1 and thus \\(clr(x_{n})\\) will be 0 as the logarithm of\n1 is equal to 0. This gives us some intuition about the size of\nCLR-transformed values. Going further on this, it means that an increase\nof 1 on a CLR-transformed scale corresponds to multiplying with\ne, Euler’s number, which is approximately equal to 2.718282.\nConversely, a decrease of 1 on a CLR-transformed scale corresponds to\ndividing by e.\nFurthermore, there are a few points to keep in mind when\ninterpreting CLR-transformed values.\nFirst, the CLR-transformation is especially useful in the scenario\nwhere most features do not change, so that the geometric mean remains\nreasonably stable between your samples. If the geometric mean is very\ndifferent between your samples, you’re dividing by very different values\nbetween your samples.\nSecond, especially for microbiome sequencing experiments, we are\nusually dealing with how many reads we found for any given organism.\nTypically, we cannot relate this back to the absolute or even the\nrelative abundances of those organisms, as all microbes have their own\nmicrobe-to-reads conversion rate. Even so, the ratios between\nthe reads are still highly informative.\nThe CLR-transformation is not a perfect solution for\ncompositionality - in fact the idea of a solution to a type of data\nseems a little odd - but in practice the CLR-transformation tends to be\na handy tool on the belt of a bioinformatician. Understanding what\nexactly it does will greatly improve its utility and reduce the chance\nof misinterpreting an analysis.\n\nFurther reading:\nUnderstanding\nsequencing data as compositions: an outlook and review\nBugs as\nfeatures (part 1): concepts and foundations for the compositional data\nanalysis of the microbiome–gut–brain axis\n\n\n\nDealing with sequencing biases and batches\nRead count data from metagenomic sequencing experiments are affected\nby a multiplicative, sequence-specific bias. This is because sequences\nfrom different taxa can be subjected to vastly different conditions\nbefore sequencing and may also differ in how effectively they can be\nbound & sequenced by modern platforms.\nOften, we have no way of estimating the per-read bias. However, we do\nknow it is multiplicative (and not additive). Therefore, we can try to\nremove the bias by dividing each feature by its geometric mean. This is\nalso known as geometric mean centering.\nLet’s imagine a microbiome feature table \\(X\\), with \\(i\\) samples as rows and\n\\(j\\) features as\ncolumns:\n\\[\nX_{i,j} =\n\\begin{pmatrix}\n  x_{1,1} & x_{1,2} & x_{1,3} & \\cdots & x_{1,j} \\\\\n  x_{2,1} & x_{2,2} & x_{2,3} & \\cdots & x_{2,j} \\\\\n  x_{3,1} & x_{3,2} & x_{3,3} & \\cdots & x_{3,j} \\\\\n  \\vdots  & \\vdots  &\\vdots  & \\ddots & \\vdots  \\\\\n  x_{i,1} & x_{i,2} & x_{i,3} & \\cdots & x_{i,j}\n\\end{pmatrix}\n\\]\nBecause we are dealing with compositional data, the values themselves\nare not informative, only the ratios between values (components) within\na composition.\nWe can divide each element of \\(\\bf{x^{*}_{j}}\\) by its geometric mean\n\\(G({\\bf x^{*}_{j}})\\) to geometric\nmean center each feature. This is different from the CLR-transformation,\nas we center over the features here instead of centering over the\nsamples. In other words:\n\\[\ncentered(X_{i,j}) =\n\\begin{pmatrix}\n  \\frac{x_{1,1}}{G({\\bf x^{*}_{1}})} & \\frac{x_{1,2}}{G({\\bf\nx^{*}_{2}})} & \\frac{x_{1,3}}{G({\\bf x^{*}_{3}})} & \\cdots &\n\\frac{x_{1,j}}{G({\\bf x^{*}_{j}})} \\\\\n  \\frac{x_{2,1}}{G({\\bf x^{*}_{1}})} & \\frac{x_{2,2}}{G({\\bf\nx^{*}_{2}})} & \\frac{x_{2,3}}{G({\\bf x^{*}_{3}})} & \\cdots &\n\\frac{x_{2,j}}{G({\\bf x^{*}_{j}})} \\\\\n  \\frac{x_{3,1}}{G({\\bf x^{*}_{1}})} & \\frac{x_{3,2}}{G({\\bf\nx^{*}_{2}})} & \\frac{x_{3,3}}{G({\\bf x^{*}_{3}})} & \\cdots &\n\\frac{x_{3,j}}{G({\\bf x^{*}_{j}})} \\\\\n  \\vdots                             &\n\\vdots                             &\n\\vdots                             & \\ddots & \\vdots  \\\\\n  \\frac{x_{i,1}}{G({\\bf x^{*}_{1}})} & \\frac{x_{i,2}}{G({\\bf\nx^{*}_{2}})} & \\frac{x_{i,3}}{G({\\bf x^{*}_{3}})} & \\cdots &\n\\frac{x_{i,j}}{G({\\bf x^{*}_{j}})}\n\\end{pmatrix}\n\\] We can center microbiome data per batch to more reasonably\ncompare between batches, as we remove the batch-specific multiplicative\nbias. Additionally, centering may have favourable properties for summed\nlog-ratio analysis, where we sum together components to make\namalgamations.\nAitchison distance is invariant to centering by feature\ngeometric means:\nset.seed(1)\n#Simulate simple microbiome data with 10 features, 20 samples and 10.000 reads per sample. \ncounts <- t(rmultinom(n = 20, 10000, prob = runif(10, min = 0.01, max = 1)))\n\n#CLR-transform each sample:\ncounts.clr = t(apply(\n  counts, 1, FUN = function(x) { log(x) - mean(log(x)) }\n  ))\n\n#Alternatively, first center each feature:\ncent_counts = apply(\n  #Here I divide by the geometric mean in log-space, to avoid rounding issues with small numbers.\n  counts, 2, FUN = function(x) {exp( log(x) - mean(log(x)))} \n  )\n\n#And then CLR-transform as before:\ncent_counts.clr = t(apply(\n  cent_counts, 1, FUN = function(x) { log(x) - mean(log(x)) }\n  ))\n\n#Aitchison distance is the same:\nall.equal(\n  c(dist(counts.clr,      method = \"euclidean\")),\n  c(dist(cent_counts.clr, method = \"euclidean\"))\n  )\n## [1] TRUE\n(Meaning beta diversity will not change, nor will differential\nabundance)\n\nQuestions\nWhat does it mean to sum together centered components?\n\n\nFurther reading:\nConsistent and\ncorrectable bias in metagenomic sequencing experiments\n\n\n\n\n\n\n\n\n\n\n\n\n",
      "last_modified": "2024-06-25T15:26:38+02:00"
    },
    {
      "path": "index.html",
      "title": "Thomaz F. S. Bastiaanssen, PhD",
      "author": [],
      "contents": "\n\n          \n          \n          Thomaz F. S. Bastiaanssen, PhD\n          \n          \n          Home\n          Notes\n          Media\n          ☰\n          \n          \n      \n        \n          \n            \n              \n            \n              Thomaz F. S. Bastiaanssen, PhD\n            \n            \n              \n                \n                    \n                      \n                        Publications\n                      \n                    \n                  \n                                    \n                    \n                      \n                        CV\n                      \n                    \n                  \n                                    \n                    \n                      \n                        Twitter\n                      \n                    \n                  \n                                    \n                    \n                      \n                        Email\n                      \n                    \n                  \n                                    \n                    \n                      \n                        GitHub\n                      \n                    \n                  \n                                    \n                    \n                      \n                        Recipes\n                      \n                    \n                  \n                                  \n            \n          \n        \n        \n        \n          \n            SummaryI am a bioinformatician\n            interested in the interplay between the gut microbiome and\n            host mood and mental health.\n            The focus of my research currently lies in understanding\n            microbiome-gut-brain communication from a theoretical\n            ecology/bioinformatics perspective. In particular, I am\n            interested in understanding the role of stability and\n            volatility of the gut microbiome in anxiety and depression\n            and in integrating different types of ’omics data in a\n            biologically interpretable manner.\n            As a bioinformatician, I value clear and easily\n            interpretable analysis of complex data in order to promote\n            interdisciplinary collaboration. After working as the lead\n            bioinformatician in Prof. Cryans lab in Cork, Ireland, I\n            have recently transitioned to a new postition in Amsterdam\n            UMC with Prof. Brenda Penninx.\n            EducationUniversity College\n            Cork | Cork, Ireland PhD | 2018 - 2021\n            Supervision of Prof. John F. Cryan, Prof. Timothy G.\n            Dinan and Dr. Marcus J. Claesson\n            Utrecht University | Utrecht,\n            Netherlands MSc | 2014 - 2017\n            Trajectory: Molecular and Cellular Life Sciences -\n            Bioinformatics\n            \n            \n            BSc | 2010 - 2013\n            Major in Biology with a Minor in Art History\n            \n            ExperienceAmsterdam\n            UMC | Netherlands Postdoctoral Researcher |\n            April 2024 - Present\n            Microbiome Bioinformatician\n            \n            APC Microbiome Ireland | Cork, Ireland\n            Postdoctoral Researcher | March 2021 - March 2024\n            Lead Bioinformatician\n            \n            \n          \n        \n      \n    \n\n    \n      \n        \n          \n            \n              \n            \n              Thomaz F. S. Bastiaanssen, PhD\n            \n            \n              \n                \n                                    \n                    \n                      Publications\n                    \n                  \n                                    \n                    \n                      CV\n                    \n                  \n                                    \n                    \n                      Twitter\n                    \n                  \n                                    \n                    \n                      Email\n                    \n                  \n                                    \n                    \n                      GitHub\n                    \n                  \n                                    \n                    \n                      Recipes\n                    \n                  \n                                  \n              \n            \n            \n              SummaryI am a bioinformatician\n              interested in the interplay between the gut microbiome and\n              host mood and mental health.\n              The focus of my research currently lies in\n              understanding microbiome-gut-brain communication from a\n              theoretical ecology/bioinformatics perspective. In\n              particular, I am interested in understanding the role of\n              stability and volatility of the gut microbiome in anxiety\n              and depression and in integrating different types of\n              ’omics data in a biologically interpretable manner.\n              As a bioinformatician, I value clear and easily\n              interpretable analysis of complex data in order to promote\n              interdisciplinary collaboration. After working as the lead\n              bioinformatician in Prof. Cryans lab in Cork, Ireland, I\n              have recently transitioned to a new postition in Amsterdam\n              UMC with Prof. Brenda Penninx.\n              EducationUniversity College\n              Cork | Cork, Ireland PhD | 2018 - 2021\n              Supervision of Prof. John F. Cryan, Prof. Timothy G.\n              Dinan and Dr. Marcus J. Claesson\n              Utrecht University | Utrecht,\n              Netherlands MSc | 2014 - 2017\n              Trajectory: Molecular and Cellular Life Sciences -\n              Bioinformatics\n              \n              \n              BSc | 2010 - 2013\n              Major in Biology with a Minor in Art History\n              \n              ExperienceAmsterdam\n              UMC | Netherlands Postdoctoral Researcher |\n              April 2024 - Present\n              Microbiome Bioinformatician\n              \n              APC Microbiome Ireland | Cork,\n              Ireland Postdoctoral Researcher | March 2021 - March\n              2024\n              Lead Bioinformatician\n              \n              \n            \n        \n      \n    \n\n    \n    \n    ",
      "last_modified": "2024-06-25T15:26:43+02:00"
    },
    {
      "path": "media.html",
      "title": "Media appearances",
      "author": [],
      "contents": "\n\n\n\n\n\n\n\n\nThomaz F. S. Bastiaanssen, PhD\n\n\nHome\nNotes\nMedia\n☰\n\n\n  \n    \n      \n        \n        \n        \n      \n      \n    \n    \n      \n  Home\n\n\n  Notes\n\n\n  Media\n\n      \n  \n\n\n\n\n\n\nMedia appearances\n\n\n\n\n\nRadio & Podcasts:\nPRV1\n(Slovenian public radio), 2021\nThe\nBeyond Addiction Show, 2021\nISAPP,\n2024\n\n\nArticles\nAPC\nGUT REACTION, 2022\n\n\n\n\n\n\n\n\n\n\n\n",
      "last_modified": "2024-06-25T15:26:43+02:00"
    }
  ],
  "collections": []
}
